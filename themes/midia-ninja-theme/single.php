<?php
/**
 * The template for displaying all single posts
 *
 * @link https://developer.wordpress.org/themes/basics/template-hierarchy/
 */

gt_set_post_view();
get_header();

$coauthors = get_coauthors();

$category = get_the_terms($post->ID, 'category');
$cat_id = $category[0]->term_id;

$cor_font = get_term_meta ( $cat_id, 'ninja_font_term_color', true );
$cor_fundo = get_term_meta ( $cat_id, 'ninja_background_term_color', true );

get_template_part( 'template-parts/header-especiais' );
?>

<div class="container">
    <main class="content">
        <?php while (have_posts()) : the_post(); ?>
            <article class="post">
                <header class="post-header">
                    <div class="post-info">
                        <div>
                            <div class="info">
                                <span class="term-<?= $category[0]->slug; ?>">
                                    <?php
                                    $categories = get_the_category();

                                    foreach ($categories as $category){
                                    echo '<a style="color:' .  $cor_font . '; background-color:' .  $cor_fundo . ';" href="' . get_category_link($category->term_id) . '">' . $category->cat_name . '</a>';

                                    }; ?>
                                </span>
                            </div>

                            <?php the_post_thumbnail();?>
                        </div>

                        <h2 class="title"><?php the_title(); ?></h2>

                        <h5 class="excerpt"><?php the_excerpt(); ?></h5>

                        <div class="author-info-mobile">
                        <?php 
                        $terms = get_the_terms(get_the_ID(), 'marcador_afluente');

                        if ($terms && !is_wp_error($terms)) {
                            foreach ($terms as $term) {
                                $afluente_name = $term->name;
                                $afluente_bio = $term->description;
                                $term_id = $term->term_id;
                                
                                $instagram = get_term_meta($term_id, 'instagram', true);
                                $facebook = get_term_meta($term_id, 'facebook', true);
                                $twitter = get_term_meta($term_id, 'twitter', true);
                                ?>
                                <div class="author-info-card">
                                    <?php echo get_avatar(get_the_author_meta('ID'), 128);?>
                                    
                                    <div class="authname">
                                        <?php echo $afluente_name; ?>
                                    </div>

                                    <hr>

                                    <div class="authbio">
                                        <?php echo $afluente_bio; ?>
                                    </div>

                                    
                                    <div class="social-networks">
                                        <?php if($instagram): ?>
                                            <span class="instagram">
                                                <a href="<?php echo $instagram; ?>">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="29" viewBox="0 0 30 29" fill="none">
                                                    <path d="M14.9462 0.0935059C7.16704 0.0935059 0.860352 6.4002 0.860352 14.1793C0.860352 21.9585 7.16704 28.2652 14.9462 28.2652C22.7253 28.2652 29.032 21.9585 29.032 14.1793C29.032 6.4002 22.7253 0.0935059 14.9462 0.0935059ZM14.9462 27.1861C7.7688 27.1827 1.95293 21.3567 1.95629 14.1793C1.95965 7.00195 7.78561 1.18608 14.963 1.18944C22.1404 1.1928 27.9563 7.01876 27.9529 14.1962C27.9529 16.0317 27.5629 17.847 26.8065 19.5212C24.7054 24.1874 20.0628 27.1861 14.9462 27.1861Z" fill="white"/>
                                                    <path d="M19.276 6.55484H10.6161C8.84442 6.53803 7.39213 7.9567 7.36523 9.72835V18.6404C7.38541 20.4154 8.84105 21.8341 10.6127 21.8139H19.2626C21.0376 21.8341 22.4899 20.4154 22.5134 18.6404V9.72835C22.4932 7.9567 21.0443 6.53803 19.276 6.55484ZM21.2191 18.6404C21.2191 19.6792 20.3787 20.5197 19.3432 20.5197C19.3197 20.5197 19.2995 20.5197 19.276 20.5197H10.6161C9.58064 20.5566 8.70994 19.7464 8.67297 18.7077C8.67297 18.6841 8.67297 18.664 8.67297 18.6404V9.72835C8.67297 8.68956 9.51341 7.84912 10.5488 7.84912C10.5724 7.84912 10.5925 7.84912 10.6161 7.84912H19.2659C20.3014 7.81214 21.1721 8.62233 21.209 9.66112C21.209 9.68465 21.209 9.70482 21.209 9.72835L21.2191 18.6404Z" fill="white"/>
                                                    <path d="M14.946 10.2158C12.7574 10.2158 10.9824 11.9908 10.9824 14.1794C10.9824 16.3679 12.7574 18.1429 14.946 18.1429C17.1345 18.1429 18.9095 16.3679 18.9095 14.1794C18.9095 11.9908 17.1345 10.2158 14.946 10.2158ZM14.946 16.7915C13.4836 16.7915 12.2969 15.6048 12.2969 14.1424C12.2969 12.68 13.4836 11.4933 14.946 11.4933C16.4083 11.4933 17.595 12.68 17.595 14.1424C17.595 14.1558 17.595 14.1659 17.595 14.1794C17.5883 15.6384 16.4083 16.8217 14.946 16.8284V16.7915Z" fill="white"/>
                                                    <path d="M19.1988 10.9486C19.7131 10.9486 20.13 10.5317 20.13 10.0174C20.13 9.5031 19.7131 9.08618 19.1988 9.08618C18.6845 9.08618 18.2676 9.5031 18.2676 10.0174C18.2676 10.5317 18.6845 10.9486 19.1988 10.9486Z" fill="white"/>
                                                    </svg>
                                                </a>
                                            </span>
                                        <?php endif; ?>
                                        <?php if($facebook): ?>
                                            <span class="facebook">
                                                <a href="<?php echo $facebook; ?>">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none">
                                                        <path d="M28.1483 9.74065C30.5554 17.1399 26.5078 25.0871 19.1085 27.4942C11.7092 29.9012 3.76201 25.8536 1.35498 18.4544C-1.05206 11.0551 2.99552 3.10786 10.3948 0.700831C11.8034 0.243629 13.2758 0.00830078 14.755 0.00830078C20.8566 0.0116626 26.2624 3.93822 28.1483 9.74065ZM14.755 1.27905C7.67512 1.28914 1.94329 7.03441 1.95337 14.1177C1.96346 21.1976 7.70873 26.9294 14.792 26.9193C21.8719 26.9092 27.6037 21.164 27.5936 14.0807C27.5903 12.7393 27.3785 11.4081 26.965 10.134C25.2471 4.8459 20.3154 1.26897 14.755 1.27905Z" fill="white"/>
                                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M17.0572 9.24322C17.5178 9.24322 17.9951 9.24322 18.4389 9.24322H18.6272V6.84963C18.3818 6.84963 18.1296 6.79248 17.8674 6.77567C17.3967 6.77567 16.9295 6.77567 16.4588 6.77567C15.7461 6.77231 15.0536 6.99083 14.4686 7.39424C13.8198 7.87161 13.3895 8.58767 13.2752 9.38441C13.2214 9.70042 13.1912 10.0198 13.1811 10.3425C13.1811 10.877 13.1811 11.4116 13.1811 11.9494V12.2218H10.8984V14.8876H13.1609V21.5843H15.9781V14.8607H18.2406L18.5129 12.2218H15.884C15.884 12.2218 15.884 10.8972 15.884 10.3425C15.9579 9.49535 16.4286 9.26002 17.0572 9.24322Z" fill="white"/>
                                                    </svg>
                                                </a>
                                            </span>
                                        <?php endif; ?>
                                        <?php if($twitter): ?>
                                            <span class="twitter">
                                                <a href="<?php echo $twitter; ?>">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" fill="none">
                                                        <path d="M28.6031 10.0878C31.0956 17.7498 26.9043 25.9793 19.2422 28.4718C11.5802 30.9643 3.35069 26.773 0.858168 19.111C-1.63435 11.4489 2.55697 3.21941 10.219 0.726891C11.6776 0.253452 13.2024 0.00976562 14.7341 0.00976562C21.0524 0.0132468 26.6502 4.07926 28.6031 10.0878ZM14.7376 1.32565C7.40625 1.33609 1.47085 7.28541 1.48129 14.6202C1.49173 21.9551 7.44106 27.887 14.7759 27.8765C22.1072 27.8661 28.0426 21.9168 28.0322 14.5819C28.0287 13.193 27.8094 11.8144 27.3812 10.4951C25.5988 5.01917 20.492 1.3152 14.7376 1.32565Z" fill="white"/>
                                                        <path d="M6.73165 7.07715L12.9386 15.3763L6.69336 22.1263H8.09976L13.5687 16.2187L17.9863 22.1263H22.7694L16.2109 13.3607L22.0244 7.08063H20.618L15.5878 12.5182L11.5183 7.07715H6.73165ZM8.79947 8.11106H10.9961L20.7016 21.0889H18.505L8.79947 8.11106Z" fill="white"/>
                                                    </svg>
                                                </a>
                                            </span>
                                        <?php endif; ?>
                                    </div>
                                </div>
                                <?php 
                                break;
                            } 
                        } 
                        ?>
                    </div>
                    <div class="author-info">
                        <?php 
                        $terms = get_the_terms(get_the_ID(), 'marcador_afluente');

                        if ($terms && !is_wp_error($terms)) {
                            foreach ($terms as $term) {
                                $afluente_name = $term->name;
                                $afluente_bio = $term->description;
                                $term_id = $term->term_id;
                                
                                $instagram = get_term_meta($term_id, 'instagram', true);
                                $facebook = get_term_meta($term_id, 'facebook', true);
                                $twitter = get_term_meta($term_id, 'twitter', true);
                                ?>
                                <div class="author-info-card">
                                    <?php echo get_avatar(get_the_author_meta('ID'), 128);?>
                                    
                                    <div class="authname">
                                        <?php echo $afluente_name; ?>
                                    </div>

                                    <hr>

                                    <div class="authbio">
                                        <?php echo $afluente_bio; ?>
                                    </div>

                                    
                                    <div class="social-networks">
                                        <?php if($instagram): ?>
                                            <span class="instagram">
                                                <a href="<?php echo $instagram; ?>">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="29" viewBox="0 0 30 29" fill="none">
                                                    <path d="M14.9462 0.0935059C7.16704 0.0935059 0.860352 6.4002 0.860352 14.1793C0.860352 21.9585 7.16704 28.2652 14.9462 28.2652C22.7253 28.2652 29.032 21.9585 29.032 14.1793C29.032 6.4002 22.7253 0.0935059 14.9462 0.0935059ZM14.9462 27.1861C7.7688 27.1827 1.95293 21.3567 1.95629 14.1793C1.95965 7.00195 7.78561 1.18608 14.963 1.18944C22.1404 1.1928 27.9563 7.01876 27.9529 14.1962C27.9529 16.0317 27.5629 17.847 26.8065 19.5212C24.7054 24.1874 20.0628 27.1861 14.9462 27.1861Z" fill="white"/>
                                                    <path d="M19.276 6.55484H10.6161C8.84442 6.53803 7.39213 7.9567 7.36523 9.72835V18.6404C7.38541 20.4154 8.84105 21.8341 10.6127 21.8139H19.2626C21.0376 21.8341 22.4899 20.4154 22.5134 18.6404V9.72835C22.4932 7.9567 21.0443 6.53803 19.276 6.55484ZM21.2191 18.6404C21.2191 19.6792 20.3787 20.5197 19.3432 20.5197C19.3197 20.5197 19.2995 20.5197 19.276 20.5197H10.6161C9.58064 20.5566 8.70994 19.7464 8.67297 18.7077C8.67297 18.6841 8.67297 18.664 8.67297 18.6404V9.72835C8.67297 8.68956 9.51341 7.84912 10.5488 7.84912C10.5724 7.84912 10.5925 7.84912 10.6161 7.84912H19.2659C20.3014 7.81214 21.1721 8.62233 21.209 9.66112C21.209 9.68465 21.209 9.70482 21.209 9.72835L21.2191 18.6404Z" fill="white"/>
                                                    <path d="M14.946 10.2158C12.7574 10.2158 10.9824 11.9908 10.9824 14.1794C10.9824 16.3679 12.7574 18.1429 14.946 18.1429C17.1345 18.1429 18.9095 16.3679 18.9095 14.1794C18.9095 11.9908 17.1345 10.2158 14.946 10.2158ZM14.946 16.7915C13.4836 16.7915 12.2969 15.6048 12.2969 14.1424C12.2969 12.68 13.4836 11.4933 14.946 11.4933C16.4083 11.4933 17.595 12.68 17.595 14.1424C17.595 14.1558 17.595 14.1659 17.595 14.1794C17.5883 15.6384 16.4083 16.8217 14.946 16.8284V16.7915Z" fill="white"/>
                                                    <path d="M19.1988 10.9486C19.7131 10.9486 20.13 10.5317 20.13 10.0174C20.13 9.5031 19.7131 9.08618 19.1988 9.08618C18.6845 9.08618 18.2676 9.5031 18.2676 10.0174C18.2676 10.5317 18.6845 10.9486 19.1988 10.9486Z" fill="white"/>
                                                    </svg>
                                                </a>
                                            </span>
                                        <?php endif; ?>
                                        <?php if($facebook): ?>
                                            <span class="facebook">
                                                <a href="<?php echo $facebook; ?>">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 29 29" fill="none">
                                                    <path d="M28.1483 9.74065C30.5554 17.1399 26.5078 25.0871 19.1085 27.4942C11.7092 29.9012 3.76201 25.8536 1.35498 18.4544C-1.05206 11.0551 2.99552 3.10786 10.3948 0.700831C11.8034 0.243629 13.2758 0.00830078 14.755 0.00830078C20.8566 0.0116626 26.2624 3.93822 28.1483 9.74065ZM14.755 1.27905C7.67512 1.28914 1.94329 7.03441 1.95337 14.1177C1.96346 21.1976 7.70873 26.9294 14.792 26.9193C21.8719 26.9092 27.6037 21.164 27.5936 14.0807C27.5903 12.7393 27.3785 11.4081 26.965 10.134C25.2471 4.8459 20.3154 1.26897 14.755 1.27905Z" fill="white"/>
                                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M17.0572 9.24322C17.5178 9.24322 17.9951 9.24322 18.4389 9.24322H18.6272V6.84963C18.3818 6.84963 18.1296 6.79248 17.8674 6.77567C17.3967 6.77567 16.9295 6.77567 16.4588 6.77567C15.7461 6.77231 15.0536 6.99083 14.4686 7.39424C13.8198 7.87161 13.3895 8.58767 13.2752 9.38441C13.2214 9.70042 13.1912 10.0198 13.1811 10.3425C13.1811 10.877 13.1811 11.4116 13.1811 11.9494V12.2218H10.8984V14.8876H13.1609V21.5843H15.9781V14.8607H18.2406L18.5129 12.2218H15.884C15.884 12.2218 15.884 10.8972 15.884 10.3425C15.9579 9.49535 16.4286 9.26002 17.0572 9.24322Z" fill="white"/>
                                                </svg>
                                                </a>
                                            </span>
                                        <?php endif; ?>
                                        <?php if($twitter): ?>
                                            <span class="twitter">
                                                <a href="<?php echo $twitter; ?>">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" fill="none">
                                                    <path d="M28.6031 10.0878C31.0956 17.7498 26.9043 25.9793 19.2422 28.4718C11.5802 30.9643 3.35069 26.773 0.858168 19.111C-1.63435 11.4489 2.55697 3.21941 10.219 0.726891C11.6776 0.253452 13.2024 0.00976562 14.7341 0.00976562C21.0524 0.0132468 26.6502 4.07926 28.6031 10.0878ZM14.7376 1.32565C7.40625 1.33609 1.47085 7.28541 1.48129 14.6202C1.49173 21.9551 7.44106 27.887 14.7759 27.8765C22.1072 27.8661 28.0426 21.9168 28.0322 14.5819C28.0287 13.193 27.8094 11.8144 27.3812 10.4951C25.5988 5.01917 20.492 1.3152 14.7376 1.32565Z" fill="white"/>
                                                    <path d="M6.73165 7.07715L12.9386 15.3763L6.69336 22.1263H8.09976L13.5687 16.2187L17.9863 22.1263H22.7694L16.2109 13.3607L22.0244 7.08063H20.618L15.5878 12.5182L11.5183 7.07715H6.73165ZM8.79947 8.11106H10.9961L20.7016 21.0889H18.505L8.79947 8.11106Z" fill="white"/>
                                                </svg>
                                                </a>
                                            </span>
                                        <?php endif; ?>
                                    </div>
                                </div>
                                <?php 
                                break;
                            } 
                        } 
                        ?>
                    </div>
                </header>

                <section class="post-content">
                    <?php the_content(); ?>

                    <div class="page-share">
                        <?php echo do_shortcode('[addtoany]'); ?>
                        <?php the_social_networks_menu() ?>
                    </div>

                </section>
            </article>
        <?php endwhile; ?>

        <section class="post-footer">
            <div class="related-posts">
                <?php get_template_part('./template-parts/content/related-posts'); ?>
            </div>
        </section>
    </main>

</div>

<?php get_footer(); ?>
